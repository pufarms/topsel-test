⚠️ 모든 작업 보고와 설명을 반드시 한글(한국어)로 작성하세요. 영어 사용 금지.

# 작업 지시서: 테스트 데이터 초기화 기능 (최고관리자 전용)

## 📋 작업 개요

사이트 개발 중 테스트로 생성된 주문 데이터를 간편하게 초기화할 수 있는 기능을 추가합니다.
**최고관리자(kgong5026) 1명만** 사용할 수 있으며, 주문 관련 데이터만 삭제합니다.

---

## ⚠️ 절대 안전 규칙

### 초기화 대상 (이것만 삭제)
- `pending_orders` 테이블의 모든 데이터
- `settlement_history` 테이블의 모든 데이터
- `deposit_history` 테이블의 모든 데이터
- `pointer_history` 테이블의 모든 데이터

### 초기화 시 함께 처리
- `members` 테이블의 예치금/포인터 잔액을 0으로 리셋

### 절대 삭제 금지 (건드리면 안 되는 것)
- `members` 테이블 자체 (잔액 리셋만, 회원 데이터 삭제 금지)
- `users` 테이블 (관리자 계정)
- `current_products` 테이블 (상품 데이터)
- `product_categories` 테이블 (카테고리)
- `site_settings` 테이블 (사이트 설정)
- `file_hashes` 테이블 (중복파일 감지용 해시 - 이것도 초기화 대상에 포함)
- 기타 모든 설정/마스터 테이블
- 모든 프론트엔드 코드, 컴포넌트, 스타일
- 모든 API 라우트, 미들웨어, 서버 설정
- DB 스키마 구조 자체 (테이블/컬럼 삭제 금지, 데이터만 삭제)

※ `file_hashes` 테이블은 엑셀 중복 업로드 감지용이므로, 주문 데이터 초기화 시 함께 비워야 다음 테스트에서 중복 감지에 걸리지 않습니다. 초기화 대상에 포함해주세요.

---

## 🎯 구현 사항

### 1. 최고관리자 권한 체크

```
접근 조건: 로그인한 관리자의 아이디가 정확히 "kgong5026"인 경우만
- 다른 SUPER_ADMIN도 이 기능 사용 불가
- 오직 kgong5026 아이디만 버튼이 보이고 실행 가능
```

### 2. 관리자 대시보드 UI

**버튼 위치:** 관리자 대시보드(/admin) 상단 영역

```
┌─────────────────────────────────────────────────────┐
│  관리자 대시보드                                      │
│                                                     │
│  ┌──────────────────────────┐                       │
│  │ 🗑️ 테스트 데이터 초기화   │  ← kgong5026에게만 보임 │
│  └──────────────────────────┘                       │
│                                                     │
│  (기존 대시보드 내용 - 변경 없음)                      │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**버튼 스타일:**
- 작고 눈에 띄지 않는 스타일 (회색 계열, 아웃라인 버튼)
- 기존 대시보드 레이아웃에 영향 없이 우측 상단에 작게 배치
- kgong5026 외 다른 관리자에게는 완전히 숨김 (렌더링 자체 안 함)

### 3. 2단계 확인 절차 (실수 방지)

**1단계: 첫 번째 확인 다이얼로그**
```
┌─────────────────────────────────────────────────┐
│  ⚠️  테스트 데이터 초기화                          │
│                                                 │
│  다음 데이터가 모두 삭제됩니다:                      │
│                                                 │
│  • 전체 주문 데이터 (pending_orders)               │
│  • 정산 이력 (settlement_history)                 │
│  • 예치금 이력 (deposit_history)                  │
│  • 포인터 이력 (pointer_history)                  │
│  • 파일 해시 (file_hashes)                       │
│  • 회원 예치금/포인터 잔액 → 0원 리셋              │
│                                                 │
│  ※ 회원정보, 상품정보, 사이트설정은 유지됩니다.       │
│                                                 │
│  [다음 단계로]                      [취소]         │
└─────────────────────────────────────────────────┘
```

**2단계: 최종 확인 (텍스트 입력)**
```
┌─────────────────────────────────────────────────┐
│  🔴 최종 확인                                     │
│                                                 │
│  이 작업은 되돌릴 수 없습니다.                      │
│  확인을 위해 아래에 "초기화" 를 입력해주세요.         │
│                                                 │
│  ┌───────────────────────────────────┐          │
│  │                                   │          │
│  └───────────────────────────────────┘          │
│                                                 │
│  [초기화 실행]  ← "초기화" 입력 전 비활성화  [취소]   │
└─────────────────────────────────────────────────┘
```

### 4. 서버 API

```
POST /api/admin/reset-test-data

권한 체크:
1. 로그인 확인
2. 관리자 권한 확인
3. 아이디가 "kgong5026"인지 확인 ← 이 조건 미충족 시 403 반환

처리 순서 (트랜잭션):
BEGIN TRANSACTION
  1. pending_orders 전체 삭제 (DELETE FROM pending_orders)
  2. settlement_history 전체 삭제
  3. deposit_history 전체 삭제
  4. pointer_history 전체 삭제
  5. file_hashes 전체 삭제
  6. members 테이블 예치금/포인터 잔액 0으로 UPDATE
COMMIT

응답:
- 성공: { success: true, deleted: { orders: N건, settlements: N건, ... } }
- 실패: { success: false, message: "초기화 실패 - 롤백 완료" }
```

### 5. 초기화 완료 후

```
🟢 토스트: "테스트 데이터 초기화 완료"
         "주문 ○건, 정산 ○건, 예치금이력 ○건, 포인터이력 ○건 삭제됨"
         "회원 잔액 리셋 완료"
```

---

## 🚨 필수 안전 규칙

1. **기존 코드 수정 금지**: 기존 컴포넌트, API, 스타일, DB 스키마를 수정하지 마세요
2. **독립적 구현**: 새로운 API 1개 + 버튼/다이얼로그 컴포넌트만 추가
3. **조건부 렌더링**: kgong5026 외 관리자에게는 버튼 자체가 렌더링되지 않아야 함
4. **기존 레이아웃 보존**: 버튼 추가로 기존 대시보드 레이아웃이 밀리거나 변경되면 안 됨
5. **데이터만 삭제**: 테이블 구조(스키마)는 절대 건드리지 않음, 데이터(행)만 삭제

## 📝 작업 언어 규칙

- 모든 작업 보고를 한글(한국어)로 작성해주세요

---

## ✅ 완료 기준

- [ ] kgong5026 로그인 시에만 초기화 버튼 표시
- [ ] 다른 관리자 로그인 시 버튼 완전히 숨김
- [ ] 2단계 확인 절차 (다이얼로그 → "초기화" 텍스트 입력)
- [ ] API에서 kgong5026 아이디 검증
- [ ] 주문/정산/이력/파일해시 데이터 삭제 + 잔액 리셋
- [ ] 회원정보/상품정보/사이트설정 등 기존 데이터 보존
- [ ] 트랜잭션 처리 (중간 실패 시 전체 롤백)
- [ ] 기존 UI/기능에 영향 없음
