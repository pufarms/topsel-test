# 세금계산서 탭 UI 개선 작업 지시

## ⚠️ 작업 전 필수 사항
- 모든 작업 과정 설명, 진행상황, 결과 보고를 **반드시 한글**로 작성해주세요.
- 영어로 표시하지 마세요. (콘솔 로그, 주석, 사용자 안내 메시지 모두 한글로)
- 작업 전 반드시 현재 코드를 확인한 후 수정하세요.
- **기존의 다른 탭(정산 이력, 예치금 이력, 포인터 이력)은 절대 수정하지 마세요.**
- 작업 완료 후 변경된 파일 목록과 변경 내용을 한글로 보고해주세요.

---

## 작업 위치
**회원 페이지 > 대시보드 > 정산관리 > 세금계산서 내역 탭**

---

## 작업 1: 상단 요약 카드 개선

### 현재 문제
취소된 건이 총 발행건수와 합계금액에 그대로 포함되어,
실제 유효 발행 금액이 0원임에도 3,790,710원처럼 잘못 표시됨.

### 수정 방향
상단 요약 카드 4개를 아래와 같이 변경합니다.

**카드 1: 총 발행건수**
- 전체 건수 (큰 숫자로 표시)
- 아래에 작은 글씨로: ✅ 유효 N건 / ❌ 취소 N건 병기

**카드 2: 유효 발행액** (기존 "총 합계금액" → 명칭 변경)
- 취소 건 제외한 실제 유효 발행 합계금액만 표시
- 기존처럼 취소 건 포함 전체 합산 금지

**카드 3: 세금계산서 (과세)**
- 유효 건수 / 유효 금액만 표시
- 취소 건 제외

**카드 4: 계산서 (면세)**
- 유효 건수 / 유효 금액만 표시
- 취소 건 제외

### 집계 기준
```
유효 발행 = popbill_issue_status = 'issued' (또는 cancelled_at IS NULL)
취소 = popbill_issue_status = 'cancelled' (또는 cancelled_at IS NOT NULL)
```

---

## 작업 2: 발행상태 뱃지 색상 체계 통일

테이블의 발행상태 컬럼을 아래 색상 체계로 통일합니다.

| 상태 | 뱃지 색상 | 표시 텍스트 |
|---|---|---|
| 발행완료 | 초록색 배경 (#dcfce7), 초록 텍스트 (#16a34a) | ✅ 발행완료 |
| 국세청 전송완료 | 파란색 배경 (#dbeafe), 파란 텍스트 (#2563eb) | 📤 전송완료 |
| 발행대기 | 노란색 배경 (#fef9c3), 주황 텍스트 (#ca8a04) | ⏳ 발행대기 |
| 취소 | 빨간색 배경 (#fee2e2), 빨간 텍스트 (#dc2626) | ❌ 취소 |

---

## 작업 3: 취소된 행 시각적 구분

취소 상태인 행 전체에 아래 스타일을 적용합니다.

- 행 전체 배경색: 연회색 (#f3f4f6)
- 공급가액, 합계금액 텍스트에 취소선(line-through) 적용
- 행 전체 텍스트 투명도: opacity 0.6
- 유효 발행 행은 흰색 배경 유지

---

## 작업 4: 발행상태 필터 탭 추가

테이블 상단에 필터 탭을 추가합니다.

```
[전체] [발행완료] [취소] [국세청전송완료]
```

- 기본값: [전체] 탭 선택 상태
- 각 탭 클릭 시 해당 상태의 건만 테이블에 표시
- 각 탭에 해당 건수를 괄호로 표시 (예: 발행완료 (3))
- 활성 탭은 색상으로 구분 (기본 파란색 계열)

---

## 작업 5: 취소일시 컬럼 추가

테이블에 "취소일" 컬럼을 추가합니다.

- 위치: 발행일 컬럼 오른쪽
- 취소된 건만 날짜 표시 (예: 2026-02-20)
- 유효 발행 건은 "-" 표시
- DB에서 `cancelled_at` 컬럼 값을 사용

---

## 작업 6: 취소 사유 툴팁

- 취소 상태 뱃지(❌ 취소)에 마우스를 올리면 툴팁으로 취소 사유 표시
- DB의 `cancel_reason` 컬럼 값을 사용
- `cancel_reason`이 비어있으면 "취소 사유 없음"으로 표시

---

## 작업 완료 후 보고 형식

아래 형식으로 한글 보고서를 작성해주세요.

```
[작업 완료 보고]

수정된 파일:
- (파일 경로 1): (변경 내용 요약)
- (파일 경로 2): (변경 내용 요약)

작업 1 결과: 완료/미완료 + 설명
작업 2 결과: 완료/미완료 + 설명
작업 3 결과: 완료/미완료 + 설명
작업 4 결과: 완료/미완료 + 설명
작업 5 결과: 완료/미완료 + 설명
작업 6 결과: 완료/미완료 + 설명

확인 필요 사항: (있으면 작성)
다음 단계 제안: (있으면 작성)
```
